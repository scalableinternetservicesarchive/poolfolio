<% provide(:title, @user.firstname + " " + @user.lastname) %>

<div class="center bd-highlight mt-5 pl-3 pr-3">
  <div class="container-fluid center">
    <div class="row">
      <div class="col-2 center">
        <h6 class="font-weight-bold">
        <%= link_to @user.firstname + "'s Homepage" , edit_user_registration_path %>
        </h6>
        <p><%=
        if @team.name.blank?
          link_to "Click to Join a team.", teams_path
        else
          @team.name + "'s Hub"
        end
        %>
        </p>
      </div>

      <div class="col center ">
        <h6>
          <b>Portfolio Total Value: </b><%=
          if @team.value.blank?
            number_to_currency("0")
          else
            number_to_currency(@team.value)
          end
          %>
        </h6>
        <i>Cash Value:</i>
      </div>

      <div class="col-2 center">
        <%= button_to "Suggest", "", class: "btn btn-lg btn-info "%>
      </div>
    </div>

    <div class="container" >
      <div class="row mt-2" style="height: 40em">
        <div class="col-2 user-hub m-2 border border-secondary rounded">
          <h5 class="font-weight-bold mt-1">Rankings</h5>
          <div class="d-flex flex-row justify-content-between">
              <div class="pt-1"><u>Team Name</u></div>
              <div class="pt-1"><u>Value</u></div>
          </div>

              <% @teams.each do |team|%>
                <div class="d-flex flex-row justify-content-between">
                  <div class=""><%= team.name %></div>
                  <div class=""><%= number_to_currency(team.value) %></div>
                </div>
              <% end %>

        </div>
        <div class="col mt-2 ">
            <div class="p-2 bg-info d-flex flex-column" style="height: 40em" >
              <h4>Suggestions</h4>
              <table class="fixed_header">
                <thead class="bg-warning">
                  <tr>
                    <th>Buy/Sell</th>
                    <th>Ticker</th>
                    <th>Quantity</th>
                    <th>Vote</th>
                    <th>Total Votes</th>
                  </tr>
                </thead>
                <tbody class="suggestion-body">
                  <% @suggestions.order(:cached_votes_score => :desc, :created_at => :asc).each do |suggestion|%>
                  <tr >
                    <!--Absolute Value for quanity - if negative, display Sell, if positive, Buy  -->
                    <% @quant = suggestion.quantity %>
                    <td>
                      <% if (@quant < 0) %>
                        <div class="sell">Sell</div>
                      <% else %>
                        <div class="buy">Buy</div>
                      <% end %>
                    </td>
                    <td><%= suggestion.ticker %></td>
                    <td><%= (@quant).abs %></td>
                    <td>
                      <%= link_to like_suggestion_path(suggestion), class: "btn btn-sm btn-like", method: :put do %>Like<% end %>
                      <%= link_to unlike_suggestion_path(suggestion), class: "btn btn-sm btn-unlike", method: :put do %>Unlike<% end %>

                    </td>
                    <td><%= (suggestion.get_upvotes.size) - (suggestion.get_downvotes.size ) %></td>
                  </tr>
                  <% end %>
                </tbody>
                </table>
            </div>
            *Sorted by: Total Votes, Creation Date*
        </div>

        <div class="col-4 bg-danger m-2 border border-secondary rounded">
          <h5 class="font-weight-bold mt-1">Holdings</h5>
          <% if @teams.blank? %>
            <div class="d-flex flex-row justify-content-between">
                <div class="pt-1"><u>No Team! <%= link_to "Join a team.", join_team_path %></u></div>
            </div>
          <% else %>
          <div class="col mt-2 p-1">
          <div class="d-flex flex-column">
            <table class="fixed_header">
              <thead>
                <tr>
                  <th>Ticker</th>
                  <th>Quanity</th>
                  <th>Price</th>
                  <th>Value</th>
                </tr>
              </thead>
              <tbody>
                <% @stocks.each do |stock|%>
                <tr>
                  <td><%= stock["ticker"] %></td>
                  <td><%= stock["quantity"] %></td>
                  <td><%= number_to_currency(stock["price"]) %></td>
                  <td><%= number_to_currency(stock["total"]) %></td>
                </tr>
                <% end %>
              </tbody>
              </table>
          </div>
          </div>
          <% end %>
        </div>
      </div>
    </div>

    <!-- <div class="d-flex bg-warning">
      <div class="p-2 bg-info">Flex item 1</div>
      <div class="p-2 flex-column">
        <div class="p-2 m-auto bg-primary">Flex item 1</div>
        <div class="p-2">Flex item 1</div>
      </div>
      <div class="p-2 ml-auto bg-danger">Flex item 3</div>
    </div> -->
  </div>
</div>
<%# <%= link_to "Edit your profile.", edit_user_registration_path %>
